
{{ define "title"}}

{{ $character := .CharacterModel.Character }}

<title>View {{ $character.Name }}</title>

{{ end }}

{{define "content"}}

{{ $character := .CharacterModel.Character }}
{{ $open := .CharacterModel.Open }}
{{ $ID := .CharacterModel.ID }}
{{ $IsAuthor := .IsAuthor }}
{{ $IsAdmin := .IsAdmin }}
{{ $author := .CharacterModel.Author }}

      <div class="container">
        <hr>
        <div class="row">
          <div class="col-sm-3 col-md-3 col-lg-3">
            <h3>{{ $character.Name }}</h3>
            <br>
            <h5>{{ $character.Occupation.Name }} of {{ $character.Homeland.Name }}, {{ $character.Cult.Rank }} of {{ $character.Cult.Name }}</h5>
              <h4>{{ if ne $character.Clan "" }}{{ $character.Clan }} Clan | {{end}}{{ if ne $character.Tribe "" }}{{ $character.Tribe }} Tribe</h4>
            {{ end }}
            

          <img class ="card-img-top" data-src="" alt="Thumbnail"
          style="width: 100%; display: block;" src="https://s3.amazonaws.com/runequeset{{ .CharacterModel.Image.Path }}"
          data-holder-rendered="true">

            <p>Author: {{ $author.UserName }}</p>
            <hr>


            <form action="" method="POST">
            <h5>Description</h5>
            {{ $character.Description }}
            <hr>
            <h5>Standard of Living: {{ $character.StandardofLiving }}</h5>
            <h5>Ransom: {{ $character.Ransom }} Lunars</h5>
            <hr>
            
            {{ if $IsAuthor }}
            <button class="btn btn-primary" type="submit" value="Update Character State">Update State</button>
            {{ end }}
            <hr>
            {{ if (or $IsAuthor (eq $IsAdmin "true")) }}
              {{ if not $character.CreationSteps.Complete }}
              <a class="btn btn-primary" href="/{{ generateCharacterCreationURL $character.CreationSteps }}/{{ $ID }}">Resume Creation</a>
              {{ else }}
              <a class="btn btn-primary" href="/modify/{{ $ID }}">Modify</a>
              {{ end }}
              <a class="btn btn-danger" href="/delete/{{ $ID }}">Delete</a></h4>
              {{ else }}
              {{ if $open }}
              <a class="btn btn-primary" href="/add_to_user_roster/{{ $ID }}">Add to Personal Roster</a>
              {{ end }}
            {{ end }}
            <hr>
            
          </div>

      <div class="col-sm-3 col-md-3 col-lg-3">
        <h4>Statistics</h4>
        {{ range $k, $stat := $character.Statistics }}
          <p title="Base: {{ $stat.Base }}
          Rune Bonus: {{ $stat.RuneBonus }}
          {{ range $u := $stat.Updates }}
          {{ $u.Event }}: {{ $u.Value }} ({{ $u.Date }})
        {{end}}">{{ $stat.Name }}: {{ $stat.Total }} ({{ multiply $stat.Total 5}}%)
        {{ if and (eq $k "POW") ( $IsAuthor) }}
                  <input type="checkbox" name="{{ $k }}-XP" value="{{ $stat.ExperienceCheck }}" id="checkbox" {{ if $stat.ExperienceCheck }}checked{{end}}>
        {{ end }}</p>
        {{ end }}

        <hr>

        {{ if (or $IsAuthor (eq $IsAdmin "true")) }}
        <h4>In Play</h4>

        <div class="input-group">
                  <div class="input-group-prepend">
                    <span class="input-group-text" id="HP-addon">HP</span>
                  </div>
                  <input {{ if lt $character.CurrentHP 3 }}style="color:red"{{end}} type="number" class="form-control" aria-describedby="HP-addon" name="HP" value ="{{ $character.CurrentHP }}" disabled>
                  <div class="input-group-append">
                      <span class="input-group-text" id="HP-addon">/{{ $character.Attributes.HP.Max }}</span>
                    </div>
        </div>  

        <div class="input-group">
                  <div class="input-group-prepend">
                    <span class="input-group-text" id="MP-addon">MP</span>
                  </div>
                  <input type="number" class="form-control" aria-describedby="MP-addon" name="MP" value ="{{ $character.CurrentMP }}">
                  <div class="input-group-append">
                      <span class="input-group-text" id="MP-addon">/{{ $character.Attributes.MP.Max }}</span>
                    </div>
        </div>  

        <div class="input-group">
                  <div class="input-group-prepend">
                    <span class="input-group-text" id="RP-addon">Rune Points</span>
                  </div>
                  <input type="number" class="form-control" aria-describedby="RP-addon" name="RP" value ="{{ $character.CurrentRP }}">
                  <div class="input-group-append">
                      <span class="input-group-text" id="RP-addon">/{{ $character.Cult.NumRunePoints }}</span>
                    </div>
        </div>        

        <hr>
        {{ end }} <!-- END in play IF -->

        <h4>Elemental Runes</h4>
        {{ range $r := $character.ElementalRunes }}
        {{ if gt $r.Total 0 }}
          <p title="{{ $r.Name }}
        Base: {{ $r.Base }}
        Homeland: {{ $r.HomelandValue }}%
        Occupation: {{ $r.OccupationValue }}%
        Cult: {{ $r.CultValue }}%{{ range $u := $r.Updates }}
        {{ $u.Event }}: {{ $u.Value }}%{{end}}">{{ $r }}
        {{ if $IsAuthor }}
        <input type="checkbox" name="{{ $r.Name }}-XP" value="{{ $r.ExperienceCheck }}" id="checkbox" {{ if $r.ExperienceCheck }}checked{{end}}>
        {{ end }}</p>
        {{ end }} <!-- END gt loop -->
        {{ end }}

        <hr>

      <h3>Power Runes</h3>
        {{ range $r := $character.PowerRunes }}
        {{ if ne $r.Total 50 }}
          <p title="{{ $r.Name }}
        Base: {{ $r.Base }}
        Homeland: {{ $r.HomelandValue }}%
        Occupation: {{ $r.OccupationValue }}%
        Cult: {{ $r.CultValue }}%{{ range $u := $r.Updates }}
        {{ $u.Event }}: {{ $u.Value }}%{{end}}">{{ $r }}{{ if $IsAuthor }}
        <input type="checkbox" name="{{ $r.Name }}-XP" value="{{ $r.ExperienceCheck }}" id="checkbox" {{ if $r.ExperienceCheck }}checked{{end}}>
        {{ end }}</p>
        {{ end }} <!-- END ne loop -->
        {{ end }}

        <hr>
        
        <h3>Abilities</h3>
        <p>Rune Points ({{ $character.Cult.Name }}): {{ $character.Cult.NumRunePoints }}</p>
        {{ range $a := $character.Attributes }}
          <p>{{ $a }}</p>
        {{ end }}

        <hr>

        <h3>Skill Categories</h3>
        {{ range $sc := $character.SkillCategories }}
          <p>{{ $sc }}</p>
        {{ end }}

        <hr>

      

      </div>

      <div class="col-sm-3 col-md-3 col-lg-3">
        <h4>Skills</h4>
        {{ range $skill := $character.Skills }}
        <p title="{{ $skill.Name }} ({{ $skill.Category }})
        Base: {{ $skill.Base }}%
        History: {{ $skill.CreationBonusValue }}%
        Category: {{ $skill.CategoryValue }}%
        Homeland: {{ $skill.HomelandValue }}%
        Occupation: {{ $skill.OccupationValue }}%
        Cult: {{ $skill.CultValue }}%
        {{ range $u := $skill.Updates }}{{ $u.Event }}: {{ $u.Value }}%
        {{end}}">{{ $skill.CoreString }} {{ if ne $skill.UserString "" }}({{ $skill.UserString}}) {{end}}({{ $skill.Base }}): {{ $skill.Total }}%
        {{ if $IsAuthor }}
        <input type="checkbox" name="{{ $skill.Name }}-XP" value="{{ $skill.ExperienceCheck }}" id="checkbox" {{ if $skill.ExperienceCheck }}checked{{end}}>
        {{ end }}</p>
        {{ end }}

      <hr>

      <h4>Passions</h4>
        {{ range $a := $character.Abilities }}
          <p title="{{ $a.Name }}{{ range $u := $a.Updates }}
        {{ $u.Event }}: {{ $u.Value }}%{{end}}">{{ $a }}
        {{ if $IsAuthor }}
        <input type="checkbox" name="{{ $a.Name }}-XP" value="{{ $a.ExperienceCheck }}" id="checkbox" {{ if $a.ExperienceCheck }}checked{{end}}>
        {{ end }}</p>
        {{ end }}

        <hr>

      <h4>Rune Spells</h4>
    
    {{ range $spell := $character.RuneSpells }}
    <p>{{ $spell }}</p>    
    {{end}}
    <hr>

    <h4>Spirit Magic</h4>
    
    {{ range $spell := $character.SpiritMagic }}
    <p>{{ $spell }}</p>    
    {{end}}

      </div>

      <div class="col-sm-3 col-md-3 col-lg-3">

        <h4>Hit Locations</h4>
        {{ range $s := $character.HitLocationMap }}
        {{ range $k, $v := $character.HitLocations }}
        {{ if eq $s $k }}
        {{ if (or $IsAuthor (eq $IsAdmin "true")) }}
          <p {{ if $v.Disabled }}style="color:red"{{end}}>{{ $v.HitLoc }} <strong>{{ $v.Name }}</strong> - Armor: {{ $v.Armor }}</p>
          <div class="input-group">
                  <div class="input-group-prepend">
                    <span class="input-group-text" id="{{ $k }}-HP-addon">HP</span>
                  </div>
                  <input type="number" class="form-control" aria-describedby="{{ $k }}-HP-addon" name="{{ $k }}-HP" value ="{{ $v.Value }}">
                  <div class="input-group-append">
                      <span class="input-group-text" id="{{ $k }}-HP-addon">/{{ $v.Max }}</span>
                    </div>
                </div>  
          {{ else }}
          <p>{{ $v }}</p>
          {{ end }}      
          <hr>
        {{ end }} <!-- END if -->
        {{ end }}
        {{ end }} <!-- END map -->

        <h4>Equipment</h4>
        {{ if (or $IsAuthor (eq $IsAdmin "true")) }}
          {{ range $ec, $eq := $character.Equipment }}
            <div class="input-group">
              <input type="text" class="form-control" aria-describedby="Equipment-{{$ec}}-addon" name="Equipment-{{$ec}}" value ="{{ $eq }}">
            </div>
            {{ end }}
        {{ else }}
                {{ range $e := $character.Equipment }}
                    <p>{{ $e }}</p>
                {{ end }}
        {{ end }} <!-- END IsAuthor Loop -->
        
      </div>
      </div>
      </div>

{{end}}
