
{{ define "title"}}

{{ $character := .CharacterModel.Character }}

<title>{{ $character.Setting }} - {{ $character.Name }}</title>

{{ end }}

{{define "content"}}

{{ $character := .CharacterModel.Character }}
{{ $open := .CharacterModel.Open }}
{{ $ID := .CharacterModel.ID }}
{{ $IsAuthor := .IsAuthor }}
{{ $IsAdmin := .IsAdmin }}
{{ $author := .CharacterModel.Author }}

      <div class="container">
        <hr>
        <div class="row">
          <div class="col-sm-3 col-md-3 col-lg-3">
            <h3>{{ $character.Name }}</h3>
            <br>
            <h5>{{ $character.Occupation.Name }} of {{ $character.Homeland.Name }}, {{ $character.Cult.Rank }} of {{ $character.Cult.Name }}</h5>
            

          <img class ="card-img-top" data-src="" alt="Thumbnail"
          style="width: 100%; display: block;" src="https://s3.amazonaws.com/runequeset{{ .CharacterModel.Image.Path }}"
          data-holder-rendered="true">

            <p>Author: {{ $author.UserName }}</p>
            <hr>


            <form action="" method="POST">
            <h5>Description</h5>
            {{ $character.Description }}
            <hr>

            
            {{ if $IsAuthor }}
            <button class="btn btn-primary" type="submit" value="Update Character State">Update State</button>
            {{ end }}
            <hr>
            {{ if (or $IsAuthor (eq $IsAdmin "true")) }}
              <a class="btn btn-primary" href="/modify/{{ $ID }}">Edit</a>
              <a class="btn btn-danger" href="/delete/{{ $ID }}">Delete</a></h4>
              {{ else }}
              {{ if $open }}
              <a class="btn btn-primary" href="/add_to_user_roster/{{ $ID }}">Add to Personal Roster</a>
              {{ end }}
            {{ end }}
            <hr>
            
          </div>

      <div class="col-sm-3 col-md-3 col-lg-3">
        <h3>Statistics</h3>
        {{ range $stat := $character.Statistics }}
          <p title="Base: {{ $stat.Base }}
          Rune Bonus: {{ $stat.RuneBonus }}
          {{ range $u := $stat.Updates }}
          {{ $u.Event }}: {{ $u.Value }} ({{ $u.Date }})
        {{end}}">{{ $stat.Name }}: {{ $stat.Total }} ({{$stat.RuneBonus}})</p>
        {{ end }}

        <hr>

        <h3>Elemental Runes</h3>
        {{ range $r := $character.ElementalRunes }}
        {{ if gt $r.Total 0 }}
          <p title="{{ $r.Name }}
        Base: {{ $r.Base }}
        Homeland: {{ $r.HomelandValue }}%
        Occupation: {{ $r.OccupationValue }}%
        Cult: {{ $r.CultValue }}%{{ range $u := $r.Updates }}
        {{ $u.Event }}: {{ $u.Value }}%{{end}}">{{ $r }}</p>
        {{ end }} <!-- END gt loop -->
        {{ end }}

        <hr>

      <h3>Power Runes</h3>
        {{ range $r := $character.PowerRunes }}
        {{ if gt $r.Total 0 }}
          <p title="{{ $r.Name }}
        Base: {{ $r.Base }}
        Homeland: {{ $r.HomelandValue }}%
        Occupation: {{ $r.OccupationValue }}%
        Cult: {{ $r.CultValue }}%{{ range $u := $r.Updates }}
        {{ $u.Event }}: {{ $u.Value }}%{{end}}">{{ $r }}</p>
        {{ end }} <!-- END ne loop -->
        {{ end }}

        <hr>
        
        <h3>Abilities</h3>
        <p>Rune Points ({{ $character.Cult.Name }}): {{ $character.Cult.NumRunePoints }}</p>
        {{ range $a := $character.Attributes }}
          <p>{{ $a }}</p>
        {{ end }}

        <hr>

        <h3>Skill Categories</h3>
        {{ range $sc := $character.SkillCategories }}
          <p>{{ $sc }}</p>
        {{ end }}

        <hr>

      

      </div>

      <div class="col-sm-3 col-md-3 col-lg-3">
        <h3>Skills</h3>
        {{ range $skill := $character.Skills }}
        <p title="{{ $skill.Name }} ({{ $skill.Category }})
        Base: {{ $skill.Base }}%
        Category: {{ $skill.CategoryValue }}%
        Homeland: {{ $skill.HomelandValue }}%
        Occupation: {{ $skill.OccupationValue }}%
        Cult: {{ $skill.CultValue }}%
        {{ range $u := $skill.Updates }}{{ $u.Event }}: {{ $u.Value }}%
        {{end}}">{{ $skill.CoreString }} {{ if ne $skill.UserString "" }}({{ $skill.UserString}}) {{end}}({{ $skill.Base }}): {{ $skill.Total }}%
        </p>
        {{ end }}
      </div>

      <hr>

      <div class="col-sm-3 col-md-3 col-lg-3">

      <h4>Passions</h4>
        {{ range $a := $character.Abilities }}
          <p title="{{ $a.Name }}
        Base: {{ $a.Base }}
        Homeland: {{ $a.HomelandValue }}%
        Occupation: {{ $a.OccupationValue }}%
        Cult: {{ $a.CultValue }}%{{ range $u := $a.Updates }}
        {{ $u.Event }}: {{ $u.Value }}%{{end}}">{{ $a }}</p>
        {{ end }}

        <hr>

      <h4>Rune Spells</h4>
    
    {{ range $spell := $character.RuneSpells }}
    <p>{{ $spell }}</p>    
    {{end}}
    <hr>

    <h4>Spirit Magic</h4>
    
    {{ range $spell := $character.SpiritMagic }}
    <p>{{ $spell }}</p>    
    {{end}}

    <hr>

        <h4>Hit Locations</h4>
        {{ range $k, $v := $character.HitLocations }}
          <p>{{ $v }}</p>
        {{ end }}


        <hr>

        <h4>Equipment</h4>
        {{ if (or $IsAuthor (eq $IsAdmin "true")) }}
          {{ range $ec, $eq := $character.Equipment }}
            <div class="input-group">
              <input type="text" class="form-control" aria-describedby="Equipment-{{$ec}}-addon" name="Equipment-{{$ec}}" value ="{{ $eq }}">
            </div>
            {{ end }}
        {{ else }}
                {{ range $e := $character.Equipment }}
                    <p>{{ $e }}</p>
                {{ end }}
        {{ end }} <!-- END IsAuthor Loop -->
        
      </div>
      </div>
      </div>

{{end}}
